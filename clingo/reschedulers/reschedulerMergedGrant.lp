request(3,"03069131922",206,36,1).
request(4,"30010625231",47,38,0).
request(5,"09077231687",67,43,0).
request(6,"02119076046",77,44,0).
request(7,"09061629920",374,90,1).
request(8,"03039417021",53,83,0).
request(10,"15010476586",397,72,0).
request(11,"22047080290",205,84,0).
request(13,"07061869637",219,64,0).
request(14,"28128223196",282,54,0).
request(15,"01081642702",274,43,1).
request(16,"20111086425",178,70,0).
request(17,"16067676425",334,36,0).
request(18,"07031868420",377,59,0).
request(19,"27011336602",348,96,0).
request(20,"27037743039",344,39,1).
request(21,"13128157784",136,61,0).
request(22,"14090097016",92,66,1).
request(23,"15010476586",361,57,1).
request(26,"23112171378",343,52,0).
request(27,"08108631311",151,33,1).
request(28,"14038529534",255,78,1).
request(29,"29070458491",60,48,1).
request(31,"14080076459",198,43,1).
request(32,"27099970538",86,93,0).
request(33,"14080065080",132,88,1).
request(34,"07107390309",381,35,0).
request(35,"03091690606",148,90,1).
request(40,"19079028791",363,51,0).
request(42,"18087462935",321,54,0).
request(43,"05108639294",154,66,0).
request(45,"14038529534",141,63,0).
request(46,"25020246770",362,48,0).
request(47,"10089680994",211,99,0).
request(48,"22020235978",67,42,0).
request(49,"01040693309",100,58,0).
request(50,"11047540965",288,78,0).
request(51,"26107568953",273,74,1).
request(52,"24121074538",77,76,0).
request(54,"13030319134",246,86,0).
request(57,"01090842087",189,56,0).
request(58,"26042222609",124,96,0).
request(59,"29011531885",91,43,1).
request(60,"26082274429",379,59,1).
request(61,"15110453618",274,64,0).
request(63,"03077400087",167,73,0).
request(64,"19087904454",354,43,1).
request(65,"09058472060",331,98,0).
request(66,"21070458555",162,79,0).
request(67,"12118073670",246,50,1).
request(69,"25077086871",72,52,0).
request(70,"01040693309",116,43,0).
request(73,"02018707147",289,78,0).
request(74,"07047495887",351,82,0).
request(75,"28027908798",116,98,0).
request(77,"09121917349",217,93,0).
request(79,"26011698565",157,37,1).
request(80,"18031420161",44,70,0).
request(83,"29099854092",195,57,0).
request(85,"01080351917",178,84,0).
request(86,"25020172406",59,100,0).
request(87,"26108939724",395,41,0).
request(88,"18090948466",349,100,1).
request(89,"03128590720",178,61,0).
request(90,"20027856127",48,57,0).
request(91,"07031868420",154,39,1).
request(92,"08129807254",128,62,0).
request(93,"28090383531",272,55,0).
request(94,"17062098433",186,45,1).
request(95,"21049083476",41,39,0).
request(96,"25020172406",205,85,0).
request(97,"24129779039",369,40,1).
request(98,"01060016001",49,98,0).
request(99,"08119927229",141,59,1).
request(100,"11111521859",264,95,0).
request(101,"10078706461",58,54,0).
request(102,"07010969371",329,98,0).
request(103,"02100903109",311,85,0).
request(104,"25098595967",208,84,0).
request(105,"31011308959",348,57,0).
request(106,"13031737219",244,70,0).
request(107,"11012242373",275,76,0).
request(108,"30049048520",155,75,0).
request(110,"18097944450",282,66,0).
request(111,"30019883864",28,32,1).
request(112,"14038529534",57,58,1).
request(113,"16040674125",124,55,1).
request(114,"28067914292",223,53,1).
request(115,"30111136310",280,48,0).
request(116,"26011698565",129,22,1).
request(118,"01077494480",135,99,0).
request(119,"25022346958",65,35,1).
request(120,"15031423294",363,46,0).
request(121,"11017906626",382,71,0).
request(122,"10027869865",36,31,1).
request(123,"22110116310",186,50,0).
request(124,"22110116310",285,45,0).
request(125,"25068085718",351,31,0).
request(127,"09121917349",229,78,0).
request(129,"26022102664",297,40,1).
request(130,"06109084688",347,46,0).
request(132,"03058211354",187,43,0).
request(133,"10049583296",82,54,1).
request(135,"05108639294",208,51,1).
request(138,"10107804162",342,54,0).
request(139,"11111521859",276,80,0).
request(141,"09059628090",195,81,0).
request(142,"23092136649",236,44,1).
request(143,"21049083476",399,19,1).
request(144,"28121760798",307,64,0).
request(145,"20111086425",142,55,0).
request(146,"06029586093",210,75,0).
request(147,"28047600714",311,36,1).
request(148,"15070017460",28,76,0).
request(149,"22047080290",242,69,0).
request(150,"21107799617",331,59,0).
request(151,"16121692160",22,61,0).
request(152,"16072107754",301,79,0).
request(153,"25020172406",272,80,0).
request(155,"25047935520",283,85,1).
request(156,"25098595967",291,69,0).
request(158,"22070464775",319,68,0).
request(160,"02079445983",82,55,0).
request(161,"04030410023",398,38,0).
request(162,"22090971668",361,59,0).
request(163,"24051542652",217,89,0).
request(164,"25010783402",130,36,1).
request(165,"07119775554",316,85,0).
request(166,"30129275191",213,39,0).
request(167,"06088987299",184,56,1).
request(169,"10089759343",226,43,1).
request(171,"11067962016",74,97,0).
request(172,"07119775554",175,70,0).
request(173,"08098920070",263,38,1).
request(175,"16047562232",175,96,0).
request(176,"15128837687",299,47,0).
request(177,"14080320360",246,97,0).
request(178,"11020757610",197,75,0).
request(179,"28081789811",204,43,0).
request(180,"27077201278",52,67,1).
request(181,"17010049793",172,49,0).
request(182,"08119927229",337,44,1).
request(183,"22070464775",347,53,0).
request(184,"29038269592",381,97,0).
request(185,"23057402721",190,38,0).
request(186,"10058849083",334,22,1).
request(187,"15119514162",222,99,0).
request(188,"17099357992",205,82,0).
request(189,"13011684092",62,97,0).
request(191,"02100903109",77,70,0).
request(193,"06011181283",56,36,0).
request(194,"03039417021",335,68,1).
request(195,"26022102664",94,26,1).
request(197,"04059166209",342,66,0).
request(198,"10081288952",148,91,0).
request(199,"30129837529",79,42,1).
request(201,"27050113631",10,37,0).
request(202,"31120218750",204,44,0).
request(203,"27077201278",276,52,0).
request(205,"22110116310",128,42,0).
request(206,"24049142177",82,66,0).
request(210,"05081665670",90,36,1).
request(211,"20010663738",300,65,0).
request(212,"14080320360",263,82,0).
request(213,"08030979390",219,96,0).
request(214,"14108130692",21,85,0).
request(215,"11060019780",372,57,0).
request(216,"20049429382",359,85,1).
request(217,"03077400087",354,58,0).
request(218,"03091690606",40,70,0).
request(219,"12069981301",204,82,0).
request(221,"14118577627",199,38,0).
request(222,"07061869637",287,49,0).
request(223,"07091607080",329,39,1).
request(224,"25069476379",24,51,0).
request(225,"29099854092",123,42,0).
request(226,"07051532344",11,72,0).
request(228,"04041509805",371,82,0).
request(229,"30019613428",86,68,0).
request(230,"30019883864",288,17,1).
request(231,"07010395288",395,96,0).
request(233,"13108526289",257,57,0).
request(234,"14120663928",284,76,0).
request(235,"09097319884",358,54,0).
request(236,"03090177837",358,42,1).
request(237,"20100512555",103,78,0).
request(238,"09109575994",143,69,0).
request(239,"23019957663",78,46,1).
request(240,"25112151714",291,59,1).
request(241,"13030319134",90,71,0).
request(242,"15079223614",375,83,1).
request(244,"18090948466",133,85,0).
request(245,"09112194957",130,64,0).
request(246,"28110952455",197,39,1).
request(247,"14090097016",290,51,1).
request(249,"14080076459",67,28,1).
request(250,"14067792540",116,79,0).
request(254,"02097398123",367,96,1).
request(255,"22081196184",296,33,1).
request(256,"25020172406",284,78,0).
request(257,"18019227695",201,59,0).
request(259,"20027856127",79,42,0).
request(260,"02030619114",16,94,0).
request(263,"12049131639",303,73,1).
request(264,"20011137468",345,52,1).
request(265,"13051641341",280,11,1).
request(266,"28011123206",124,78,0).
request(267,"29017979765",72,43,1).
request(268,"27110709980",104,54,0).
request(269,"30030918848",183,90,0).
request(270,"04078693324",116,38,0).
request(272,"01020793400",179,43,1).
request(273,"03069131922",275,16,1).
request(274,"08038930478",46,44,1).
request(275,"30077743984",154,62,0).
request(276,"20118619400",362,81,0).
request(278,"31081198066",319,92,0).
request(279,"07031868420",315,36,1).
request(282,"26107568953",27,59,0).
request(283,"13049450334",82,80,0).
request(284,"09059628090",323,76,0).
request(285,"07031868420",58,35,1).
request(287,"22070464775",382,48,0).
request(289,"25068085718",204,16,1).
request(290,"15128837687",363,32,0).
request(291,"20107226795",197,76,0).
request(292,"15028839155",69,79,0).
request(293,"27050113631",372,22,1).
request(294,"28028919000",368,96,0).
request(295,"03029282344",104,34,1).
request(296,"06042279726",340,99,0).
request(297,"17099848958",280,45,0).
request(299,"21107799617",327,44,0).
request(300,"09097319884",344,39,0).
request(302,"01058603679",211,78,0).
request(303,"11018404043",394,71,0).
request(304,"06079178007",205,78,0).
request(305,"21110933740",253,67,0).
request(306,"02019458898",343,57,0).
request(308,"08051947979",233,90,0).
request(312,"19027298546",49,45,1).
request(313,"28028901107",348,34,0).
request(314,"27028139080",217,50,1).
request(315,"29040387572",97,40,1).
request(316,"08049025789",305,83,0).
request(317,"10081288952",98,76,1).
request(318,"24121074538",198,61,0).
request(319,"29051648383",185,78,0).
request(320,"31017567723",120,84,0).
request(321,"23019957663",338,31,0).
request(322,"20058506203",175,42,0).
request(323,"25059802303",235,84,0).
request(324,"19018047092",313,49,1).
request(325,"18029871862",76,46,1).
request(326,"27110709980",241,40,0).
request(327,"27040740360",299,91,0).
request(328,"21119177802",34,68,0).
request(329,"14098535884",48,92,0).
request(330,"09109063389",263,54,0).
request(332,"16058164738",181,80,0).
request(334,"28088518205",245,76,0).
request(335,"05120736508",219,36,1).
request(336,"24050800721",302,49,0).
request(337,"08129807254",77,47,0).
request(338,"04041509805",34,68,0).
request(339,"11080212696",213,35,0).
request(340,"11090791663",267,85,0).
request(341,"11101679170",295,42,1).
request(342,"08098920070",19,23,0).
request(344,"23092136649",171,39,1).
request(345,"07059524921",189,54,0).
request(346,"03050224041",18,67,0).
request(347,"06029586093",299,60,0).
request(349,"15079223614",277,68,1).
request(350,"16020742124",172,82,0).
request(352,"28028919000",83,81,0).
request(353,"06027047726",185,54,0).
request(355,"22020235978",302,27,0).
request(356,"13018154552",207,92,1).
request(357,"08129807254",261,42,0).
request(358,"28089389648",185,34,0).
request(359,"10089759343",134,38,1).
request(360,"11038432289",20,71,0).
request(362,"10089680994",136,84,0).
request(363,"30030918848",282,74,0).
request(364,"15081910042",294,67,0).
request(369,"03050224041",372,52,0).
request(370,"21111453037",121,79,0).
request(371,"28089537931",51,66,0).
request(374,"06120437014",155,82,0).
request(376,"26022102664",282,20,1).
request(377,"13049450334",174,65,0).
request(378,"03080925567",265,39,1).
request(379,"30019883864",19,12,1).
request(380,"29040387572",187,25,1).
request(381,"21107799617",15,39,0).
request(384,"22090971668",362,44,1).
request(386,"16080129998",102,96,1).
request(387,"01058603679",59,63,0).
request(388,"22068453442",301,37,1).
request(390,"20070461361",235,88,0).
request(393,"29019490670",315,82,0).
request(394,"31077774201",113,78,0).
request(396,"21017301876",17,39,1).
request(397,"12059124920",130,78,0).
request(398,"28088518205",21,61,1).
request(400,"28128079556",269,45,1).


% RULES
%% GRANTED RULE
granted(R) :- request(R,_,_,_,ST), ST = 1.
%% WAITING RULE
appointed(P) :- request(R,P,_,_,_), granted(R).
%% NOT ONLY OPTION RULE
onlyOption(R) :- request(R,P,_,_,_), 0 {request(X,P,_,_,_) :  R != X} 0.
%% BEST RULE
best(R) :- request(R,P,_,S,_), 0 {request(X,P,_,SX,_) : S < SX, R != X} 0.

% SET CREATION
0 {grant(R,S)} 1 :- request(R,P,_,S,_), granted(R), not best(R).
0 {grant(R,S)} 1 :- request(R,P,_,S,_), not granted(R), request(X,P,_,SX,_), granted(X), R != X, S > SX.
0 {grant(R,S)} 1 :- request(R,P,_,S,_), not appointed(P).

%% FRAME AXIOM
claimed(R) :- granted(R), best(R).

% INTEGRITY CONSTRAINTS
%% A timeslot can be appointed only to one patient
:- request(R,_,T,_,_), grant(R,_), request(X,_,T,_,_), grant(X,_), R != X.
%% Only one timeslot can be appointed to a patient
:- request(R,P,_,_,_), grant(R,_), request(X,P,_,_,_), grant(X,_), R != X.
% If a request has a lower score than someone's only option it won't be considered in the optimizatioin process
:- request(R,_,T,S,_), grant(R,_), request(X,_,T,SX,_), R != X, S < SX, onlyOption(X).
% Claimed requests aren't taken into consideration in the optimization process
:- grant(R,_), claimed(R).
% If a request is claimed all the other requests for the same timeslot won't be considered in the optimizatioin process
:- request(R,_,T,_,_), grant(R,_), request(X,_,T,_,_), claimed(X), R != X.

% OPTIMIZATION
#maximize{ S, R : grant(R,S)}.

#show grant/2.
#show claimed/1.
